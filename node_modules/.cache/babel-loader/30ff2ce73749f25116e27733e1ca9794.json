{"ast":null,"code":"import _regeneratorRuntime from\"/Users/anastasia/Documents/React-BC-22/goit-react-hw-08-phonebook/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/anastasia/Documents/React-BC-22/goit-react-hw-08-phonebook/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import axios from\"axios\";import authActions from\"./authActions\";axios.defaults.baseURL=\"https://goit-phonebook-api.herokuapp.com\";export var token={set:function set(token){axios.defaults.headers.common.Authorization=\"Bearer \".concat(token);},unset:function unset(){axios.defaults.headers.common.Authorization=\"\";}};var register=function register(credentials){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(authActions.registerRequest());console.log(credentials);_context.prev=2;_context.next=5;return axios.post(\"users/signup\",credentials);case 5:response=_context.sent;console.log(\"response\",response);token.set(response.data.token);dispatch(authActions.registerSuccess(response.data));_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](2);dispatch(authActions.registerError(_context.t0.message));case 14:case\"end\":return _context.stop();}}},_callee,null,[[2,11]]);}));return function(_x){return _ref.apply(this,arguments);};}();};var login=function login(credentials){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch(authActions.loginRequest());_context2.prev=1;_context2.next=4;return axios.post(\"users/login\",credentials);case 4:response=_context2.sent;token.set(response.data.token);dispatch(authActions.loginSuccess(response.data));_context2.next=12;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](1);dispatch(authActions.loginError(_context2.t0.message));case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[1,9]]);}));return function(_x2){return _ref2.apply(this,arguments);};}();};var logout=function logout(){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:dispatch(authActions.logoutRequest());_context3.prev=1;_context3.next=4;return axios.post(\"users/logout\");case 4:token.unset();dispatch(authActions.logoutSuccess());_context3.next=11;break;case 8:_context3.prev=8;_context3.t0=_context3[\"catch\"](1);dispatch(authActions.logoutError(_context3.t0.message));case 11:case\"end\":return _context3.stop();}}},_callee3,null,[[1,8]]);}));return function(_x3){return _ref3.apply(this,arguments);};}();};var getCurrentUser=function getCurrentUser(){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch,getState){var _getState,persistedToken,response;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_getState=getState(),persistedToken=_getState.auth.token;if(persistedToken){_context4.next=3;break;}return _context4.abrupt(\"return\");case 3:token.set(persistedToken);dispatch(authActions.getCurrentUserRequest());_context4.prev=5;_context4.next=8;return axios.get(\"/users/current\");case 8:response=_context4.sent;dispatch(authActions.getCurrentUserSuccess(response.data));_context4.next=15;break;case 12:_context4.prev=12;_context4.t0=_context4[\"catch\"](5);dispatch(authActions.getCurrentUserError(_context4.t0.message));case 15:case\"end\":return _context4.stop();}}},_callee4,null,[[5,12]]);}));return function(_x4,_x5){return _ref4.apply(this,arguments);};}();};export default{register:register,login:login,logout:logout,getCurrentUser:getCurrentUser};","map":{"version":3,"sources":["/Users/anastasia/Documents/React-BC-22/goit-react-hw-08-phonebook/src/redux/auth/authOperations.js"],"names":["axios","authActions","defaults","baseURL","token","set","headers","common","Authorization","unset","register","credentials","dispatch","registerRequest","console","log","post","response","data","registerSuccess","registerError","message","login","loginRequest","loginSuccess","loginError","logout","logoutRequest","logoutSuccess","logoutError","getCurrentUser","getState","persistedToken","auth","getCurrentUserRequest","get","getCurrentUserSuccess","getCurrentUserError"],"mappings":"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","sourcesContent":["import axios from \"axios\";\nimport authActions from \"./authActions\";\n\naxios.defaults.baseURL = \"https://goit-phonebook-api.herokuapp.com\";\n\nexport const token = {\n  set(token) {\n    axios.defaults.headers.common.Authorization = `Bearer ${token}`;\n  },\n  unset() {\n    axios.defaults.headers.common.Authorization = \"\";\n  },\n};\n\nconst register = (credentials) => async (dispatch) => {\n  dispatch(authActions.registerRequest());\n  console.log(credentials);\n  try {\n    const response = await axios.post(\"users/signup\", credentials);\n\n    console.log(\"response\", response);\n    token.set(response.data.token);\n    dispatch(authActions.registerSuccess(response.data));\n  } catch (error) {\n    dispatch(authActions.registerError(error.message));\n  }\n};\n\nconst login = (credentials) => async (dispatch) => {\n  dispatch(authActions.loginRequest());\n\n  try {\n    const response = await axios.post(\"users/login\", credentials);\n\n    token.set(response.data.token);\n    dispatch(authActions.loginSuccess(response.data));\n  } catch (error) {\n    dispatch(authActions.loginError(error.message));\n  }\n};\n\nconst logout = () => async (dispatch) => {\n  dispatch(authActions.logoutRequest());\n\n  try {\n    await axios.post(\"users/logout\");\n\n    token.unset();\n    dispatch(authActions.logoutSuccess());\n  } catch (error) {\n    dispatch(authActions.logoutError(error.message));\n  }\n};\n\nconst getCurrentUser = () => async (dispatch, getState) => {\n  const {\n    auth: { token: persistedToken },\n  } = getState();\n  if (!persistedToken) {\n    return;\n  }\n  token.set(persistedToken);\n  dispatch(authActions.getCurrentUserRequest());\n  try {\n    const response = await axios.get(\"/users/current\");\n    dispatch(authActions.getCurrentUserSuccess(response.data));\n  } catch (error) {\n    dispatch(authActions.getCurrentUserError(error.message));\n  }\n};\nexport default { register, login, logout, getCurrentUser };\n"]},"metadata":{},"sourceType":"module"}